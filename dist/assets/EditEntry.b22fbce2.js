import{l as v,o as c,c as d,b as s,t as m,s as g,p as G,h as E,u as j,y as S,m as U,v as B,x as F,F as w,n as $,g as I,O as p}from"./main.8a2f4785.js";import{M}from"./MenuBar.dca5e5a5.js";import{a as b}from"./api_client.f45c9317.js";import{U as R}from"./UserSelector.fa65e289.js";import{_ as k}from"./_plugin-vue_export-helper.cdc0426e.js";const T=n=>(G("data-v-cebeffe0"),n=n(),E(),n),N=T(()=>s("div",{class:"loader"},null,-1)),O={class:"message"},A={__name:"Loading",props:["bind"],emits:["close"],setup(n,{emit:h}){const r=v({isClosed:!1});return(u,l)=>(c(),d("div",{class:g(`loading-view ${r.isClosed?"fade-out":"fade-in"}`)},[N,s("p",O,m(n.bind.message||"\u3057\u3070\u3089\u304F\u304A\u5F85\u3061\u304F\u3060\u3055\u3044"),1)],2))}},x=k(A,[["__scopeId","data-v-cebeffe0"]]);const z={class:"title slide-in"},H={class:"message slide-in"},q={__name:"Dialog",props:["bind"],emits:["close"],setup(n,{emit:h}){const{bind:r}=n,u=v({isClosed:!1}),l=()=>{h("close"),document.removeEventListener("animationend",l)},i=()=>{u.isClosed=!0,document.addEventListener("animationend",l)},y=()=>{var _,f;i(),(f=(_=r.button)==null?void 0:_.callback)==null||f.call(_)};return(_,f)=>(c(),d("div",{class:g(`dialog-view ${u.isClosed?"fade-out":"fade-in"}`)},[s("p",z,m(n.bind.title),1),s("p",H,m(n.bind.message),1),s("button",{class:"ui-button slide-in",onClick:y},m(n.bind.button.message),1)],2))}},J=k(q,[["__scopeId","data-v-d747c9e2"]]);const a=n=>(G("data-v-6b012bfa"),n=n(),E(),n),K={class:"post-view"},P={class:"post-content"},Q=a(()=>s("h2",{class:"section-title"},"\u3064\u3076\u3084\u304D\u3092\u66F8\u304F",-1)),W=a(()=>s("h2",{class:"section-title"},"\u30E1\u30C7\u30A3\u30A2\u3092\u6DFB\u4ED8\u3059\u308B",-1)),X=a(()=>s("i",{class:"fas fa-plus-circle"},null,-1)),Y=a(()=>s("p",null,"\u30D5\u30A1\u30A4\u30EB\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3059\u308B",-1)),Z=[X,Y],ss={key:1,class:"media-wrap"},es=["src"],ts=["src","type"],os=["onClick"],ns=a(()=>s("i",{class:"fas fa-trash-alt"},null,-1)),as=[ns],is={key:0,class:"col"},ls=a(()=>s("i",{class:"fas fa-plus-circle"},null,-1)),cs=a(()=>s("p",null,"\u8FFD\u52A0\u3059\u308B",-1)),ds=[ls,cs],rs=a(()=>s("h2",{class:"section-title"},"\u516C\u958B\u7BC4\u56F2\u3092\u9078\u629E",-1)),us={key:2,class:"publish-level-selector"},_s=a(()=>s("i",{class:"fas fa-user-friends"},null,-1)),ps=["onClick"],ms=a(()=>s("i",{class:"fas fa-users-cog"},null,-1)),fs=a(()=>s("i",{class:"fas fa-lock-open"},null,-1)),vs=a(()=>s("p",null,"\u5168\u54E1\u516C\u958B",-1)),gs=[fs,vs],hs=a(()=>s("i",{class:"fas fa-plus-circle"},null,-1)),ys=a(()=>s("p",null,"\u65B0\u898F\u30B0\u30EB\u30FC\u30D7\u3092\u4F5C\u6210\u3059\u308B",-1)),bs=[hs,ys],ks=a(()=>s("div",{class:"blank"},null,-1)),Cs={__name:"EditEntry",setup(n){const h=j(),r=v({defaultGroup:null,customGroups:[]}),u=S(null),l=v({files:[]}),i=v({groupId:null,mediaIds:[],content:""}),y=async()=>{const o=await b.get("/groups");!o.ok||(r.defaultGroup=o.defaultGroup,r.customGroups=o.customGroups,i.groupId=o.defaultGroup.id)};(async()=>await y())();const _=async o=>{if(o.target.files.length+l.files.length>4){alert("\u6DFB\u4ED8\u3067\u304D\u308B\u30E1\u30C7\u30A3\u30A2\u306F4\u3064\u307E\u3067\u3067\u3059"),o.target.value="";return}l.files.push(...Array.from(o.target.files).map(t=>({original:t,url:URL.createObjectURL(t),type:t.type.split("/")[0]}))),o.target.value=""},f=o=>{l.files=l.files.filter(t=>t!==o)},L=async()=>{const o=new FormData;l.files.forEach(e=>o.append("media",e.original));const t=await b.post("/media/upload",o,{headers:{"Content-Type":"multipart/form-data"}});i.mediaIds=t.media.map(e=>e.id)},V=()=>{p.setView(R,{created:y})},D=async()=>{if(!i.content)return alert("\u3064\u3076\u3084\u304D\u3092\u66F8\u3044\u3066\u304F\u3060\u3055\u3044");l.files.length&&(p.setView(x,{message:"\u30E1\u30C7\u30A3\u30A2\u3092\u51E6\u7406\u3057\u3066\u307E\u3059"}),await L()),p.close(),p.setView(x,{message:"\u3064\u3076\u3084\u304D\u3092\u51E6\u7406\u3057\u3066\u307E\u3059"});const o=await b.post("/entries",{...i});p.close(),p.setView(J,{title:"Congratulations!",message:"\u3064\u3076\u3084\u304D\u3092\u6295\u7A3F\u3057\u307E\u3057\u305F! Twitter\u3067\u30D5\u30A9\u30ED\u30EF\u30FC\u3055\u3093\u306B\u4F1D\u3048\u307E\u3057\u3087\u3046!",button:{message:"Twitter\u306B\u6295\u7A3F",callback:()=>{h.push("/home"),window.open(`https://twitter.com/share?url=${encodeURI(`chirpers.wintu.dev/e/${o.entry.uuid}`)}`,"_blank").focus()}}})};return(o,t)=>(c(),d("div",K,[U(M,{class:"menu"}),s("div",P,[Q,B(s("textarea",{class:"ui-textarea",placeholder:"\u3053\u3053\u306B\u3064\u3076\u3084\u304D\u3092\u66F8\u304D\u307E\u3057\u3087\u3046...","onUpdate:modelValue":t[0]||(t[0]=e=>i.content=e)},null,512),[[F,i.content]]),W,l.files.length?(c(),d("div",ss,[(c(!0),d(w,null,$(l.files,(e,C)=>(c(),d("div",{class:"col",key:`idx-${C}`},[e.type==="image"?(c(),d("img",{key:0,src:e.url,class:"media"},null,8,es)):(c(),d("video",{key:1,class:"media",src:e.url,type:e.original.type,controls:""},null,8,ts)),s("span",{class:"delete",onClick:ws=>f(e)},as,8,os)]))),128)),l.files.length<4?(c(),d("div",is,[s("div",{class:"no-media",onClick:t[2]||(t[2]=e=>u.value.click())},ds)])):I("",!0)])):(c(),d("div",{key:0,class:"no-media",onClick:t[1]||(t[1]=e=>u.value.click())},Z)),s("input",{type:"file",ref_key:"fileInput",ref:u,style:{display:"none"},accept:".mp4,.mov,.jpg,.png,.jpeg",multiple:"",onChange:_},null,544),rs,r.defaultGroup?(c(),d("div",us,[s("div",{class:g(`col ${r.defaultGroup.id===i.groupId?"active":""}`),onClick:t[3]||(t[3]=e=>i.groupId=r.defaultGroup.id)},[_s,s("p",null,m(r.defaultGroup.name),1)],2),(c(!0),d(w,null,$(r.customGroups,e=>(c(),d("div",{key:e.id,class:g(`col ${e.id===i.groupId?"active":""}`),onClick:C=>i.groupId=e.id},[ms,s("p",null,m(e.name),1)],10,ps))),128)),s("div",{class:g(`col ${i.groupId?"":"active"}`),onClick:t[4]||(t[4]=e=>i.groupId=null)},gs,2),s("div",{class:"col",onClick:t[5]||(t[5]=e=>V())},bs)])):I("",!0),s("div",{class:"btn-center"},[s("button",{class:"ui-button",onClick:D},"\u6295\u7A3F\u3059\u308B")]),ks])]))}},Ls=k(Cs,[["__scopeId","data-v-6b012bfa"]]);export{Ls as default};
